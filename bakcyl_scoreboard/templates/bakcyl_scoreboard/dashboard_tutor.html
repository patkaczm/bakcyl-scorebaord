{% extends "task_detail_base.html" %}

{% load static %}
{% load crispy_forms_tags %}

{% block header %}
    <h3> Dashboard </h3>
{% endblock %}

{% block content_rhs %}
    <div class="shadow p-3 mb-5 bg-white rounded">
        {% if user.is_authenticated %}
            {% if selectedStudent %}
                <div class="row justify-content-center mb-4">
                    <h3> Task info for: {{ selectedStudent }}</h3>
                </div>
                    {% include "task_chart_user_view.html" with user=selectedStudent %}
            {% elif selectedTask %}
                <div class="row justify-content-center mb-4">
                    <h3> Task info for: {{ selectedTask.name }}</h3>
                </div>
                    {% include "task_chart_task_view.html" with task=selectedTask %}
            {% else %}
                None
            {% endif %}
        {% else %}
            Login <a href="/login">here.</a>
        {% endif %}
    </div>
{% endblock %}

{% block content_lhs %}
<!-- @todo use template for this tasks -->
<div id="accordion">
    <div class="card">
        <div class="card-header" id="headingOne">
            <h5 class="mb-0">
                <button class="btn btn-link nounderline" data-toggle="collapse" data-target="#alltask" aria-expanded="true" aria-controls="alltask">
                Tasks
                </button>
            </h5>
        </div>
        <div id="alltask" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
            <div class="card-body">
                <div class="list-group">
                    {% for task in tasks %}
                        <form method="POST" class="form-group m-0">
                                {% csrf_token %}
                                <button type="submit" value="{{task.id}}" name="showStatisticsTask" class="list-group-item list-group-item-action list-group-item-primary">{{task.name}}</button>
                        </form>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    <div class="card">
            <div class="card-header" id="headingOne">
                <h5 class="mb-0">
                    <button class="btn btn-link nounderline" data-toggle="collapse" data-target="#allstudents" aria-expanded="true" aria-controls="allstudents">
                    Students
                    </button>
                </h5>
            </div>
            <div id="allstudents" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
                <div class="card-body">
                    <div class="list-group">
                        {% for student in students %}
                            <form method="POST" class="form-group m-0">
                                    {% csrf_token %}
                                    <button type="submit" value="{{student.user}}" name="showStatisticsUser" class="list-group-item list-group-item-action list-group-item-primary">{{student.first_name}} {{student.last_name}}</button>
                            </form>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
</div>

{% endblock %}